drop database employee;
create database employee;
use employee;
 
 CREATE TABLE DEPT ( DEPTNO INT PRIMARY KEY, DNAME VARCHAR(50), DLOC VARCHAR(50) );
  CREATE TABLE EMPLOYEE ( EMPNO INT PRIMARY KEY, ENAME VARCHAR(50), MGR_NO INT, HIREDATE DATE, SAL DECIMAL(10,2), DEPTNO INT, FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO) );
 CREATE TABLE PROJECT ( PNO INT PRIMARY KEY, PNAME VARCHAR(50), PLOC VARCHAR(50) );
  CREATE TABLE INCENTIVES ( EMPNO INT, INCENTIVE_DATE DATE, INCENTIVE_AMOUNT DECIMAL(10,2), PRIMARY KEY (EMPNO, INCENTIVE_DATE), FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO) );
  CREATE TABLE ASSIGNED_TO ( EMPNO INT, PNO INT, JOB_ROLE VARCHAR(50), PRIMARY KEY (EMPNO, PNO), FOREIGN KEY (EMPNO) REFERENCES EMPLOYEE(EMPNO), FOREIGN KEY (PNO) REFERENCES PROJECT(PNO) ); 
  INSERT INTO DEPT VALUES (10, 'HR', 'Bengaluru'), (20, 'Finance', 'Hyderabad'), (30, 'IT', 'Mysuru'), (40, 'Admin', 'Delhi'), (50, 'Marketing', 'Chennai'); 
  INSERT INTO EMPLOYEE VALUES (101, 'Ravi', NULL, '2022-06-15', 50000, 10), (102, 'Megha', 101, '2021-03-10', 60000, 20), (103, 'Arjun', 102, '2020-11-05', 55000, 30), (104, 'Divya', 101, '2023-01-20', 48000, 40), (105, 'Kiran', 103, '2022-09-11', 52000, 50);
  INSERT INTO PROJECT VALUES (1001, 'ERP Upgrade', 'Bengaluru'), (1002, 'Cloud Setup', 'Hyderabad'), (1003, 'AI Model', 'Mysuru'), (1004, 'Audit System', 'Delhi'), (1005, 'Ad Campaign', 'Chennai');
  INSERT INTO INCENTIVES VALUES (101, '2023-04-01', 5000), (103, '2023-04-01', 3000), (105, '2023-04-01', 2000);
  INSERT INTO ASSIGNED_TO VALUES (101, 1001, 'Manager'), (102, 1002, 'Analyst'), (103, 1003, 'Developer'), (104, 1004, 'Assistant'), (105, 1005, 'Designer');
SELECT DISTINCT A.EMPNO FROM ASSIGNED_TO A JOIN PROJECT P ON A.PNO = P.PNO WHERE P.PLOC IN ('Bengaluru', 'Hyderabad', 'Mysuru');
 SELECT E.ENAME, E.EMPNO, DNAME, E.DEPTNO, D.DLOC AS DEPT_LOCATION, P.PLOC AS PROJECT_LOCATION, A.JOB_ROLE FROM EMPLOYEE E JOIN DEPT D ON E.DEPTNO = D.DEPTNO JOIN ASSIGNED_TO A ON E.EMPNO = A.EMPNO JOIN PROJECT P ON A.PNO = P.PNO WHERE D.DLOC = P.PLOC;
